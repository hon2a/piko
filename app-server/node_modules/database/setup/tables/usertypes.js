var DbTableInitializer = require('../DbTableInitializer'),
	fn = require('functions');

var UsertypesInitializer = module.exports = DbTableInitializer.extend({

	create: function (callback) {
		this.adapter.create({fields: "\
			`id` int(10) unsigned NOT NULL AUTO_INCREMENT,\
			`name` varchar(30) COLLATE utf8_czech_ci NOT NULL,\
			`privileges` int(40) unsigned NOT NULL,\
			PRIMARY KEY (`id`)\
			"}, callback);
	},

	populate: function (callback) {
		this.adapter.insertMore([{
			name: 'SUPER',
			privileges: 4294967295
		}, {
			name: 'guest',
			privileges: 0
		}], fn.proxy(function (err) {
			if (!fn.handleError(err, 'Cannot populate usertypes table.', callback)) {
				callback(null);
			}
		}, this));
	}

});