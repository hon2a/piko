var DbTableAdapter = require('./DbTableAdapter'),
	util = require('util'),
	fn = require('functions');

var DbViewAdapter = module.exports = DbTableAdapter.extend({

	constructor: function (o) {
		this.base(o);
		this.table = this.table || o.view;
	},

	create: function (options, callback) {
		this.query(util.format("CREATE OR REPLACE ALGORITHM=UNDEFINED DEFINER=CURRENT_USER SQL SECURITY DEFINER VIEW `%s` AS %s",
				this.table, options.query), callback);
	},

	insert: function (data, callback) {
		callback(new Error('Cannot insert into a view.'));
	},

	update: function (data, conditions, callback) {
		callback(new Error('Cannot update a view.'));
	}

});